local Services = loadstring(game:HttpGet("https://raw.githubusercontent.com/AccountBurner/Utility/refs/heads/main/Services"))();
local Players, Workspace = Services:Get('Players', 'Workspace');
local CurrentCamera = Workspace.CurrentCamera;
local RunService = game:GetService("RunService");
local UserInputService = game:GetService("UserInputService");

-- ğŸ”¥ CHAMS CONFIG ğŸ”¥
local ChamsConfig = {
    Enabled = true,
    FillColor = Color3.fromRGB(255, 0, 0),
    OutlineColor = Color3.fromRGB(255, 255, 255),
    FillTransparency = 0.5,
    OutlineTransparency = 0,
    TeamCheck = true,
};

-- ğŸ”¥ AUTOFIRE CONFIG ğŸ”¥
local AutofireConfig = {
    Enabled = true,
    Delay = 0.1, -- Delay between shots
    MaxDistance = 500, -- Max range to autofire
    LastShot = 0,
};

-- ğŸ”¥ CHAMS SYSTEM ğŸ”¥
local ChamsObjects = {};

local function CreateChams(player_id, character)
    if ChamsObjects[player_id] then return end;
    
    local highlight = Instance.new("Highlight");
    highlight.Name = "EnemyChams_" .. player_id;
    highlight.FillColor = ChamsConfig.FillColor;
    highlight.OutlineColor = ChamsConfig.OutlineColor;
    highlight.FillTransparency = ChamsConfig.FillTransparency;
    highlight.OutlineTransparency = ChamsConfig.OutlineTransparency;
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop;
    highlight.Enabled = true;
    highlight.Parent = character;
    
    ChamsObjects[player_id] = highlight;
end;

local function RemoveChams(player_id)
    if ChamsObjects[player_id] then
        ChamsObjects[player_id]:Destroy();
        ChamsObjects[player_id] = nil;
    end;
end;

local function UpdateChams()
    if not ChamsConfig.Enabled then
        for player_id, highlight in pairs(ChamsObjects) do
            highlight.Enabled = false;
        end;
        return;
    end;
    
    local _G = getrenv()._G;
    local globals = _G.globals;
    local cli_state = globals.cli_state;
    local sol_teams = globals.sol_teams;
    local soldiers_spawned = globals.soldiers_spawned;
    local soldiers_alive = globals.soldiers_alive;
    local soldier_models = globals.soldier_models;
    
    local fpv_id = cli_state.fpv_sol_id;
    local local_team = sol_teams[fpv_id];
    
    -- Clean up old chams
    for player_id, highlight in pairs(ChamsObjects) do
        if not soldiers_spawned[player_id] or not soldiers_alive[player_id] then
            RemoveChams(player_id);
        end;
    end;
    
    -- Create/update chams
    for player_id, spawned in pairs(soldiers_spawned) do
        if spawned and soldiers_alive[player_id] and player_id ~= fpv_id then
            -- Team check
            if ChamsConfig.TeamCheck and sol_teams[player_id] == local_team then
                RemoveChams(player_id);
                continue;
            end;
            
            local character = soldier_models[player_id];
            if character and character.PrimaryPart then
                if not ChamsObjects[player_id] then
                    CreateChams(player_id, character);
                end;
                
                local highlight = ChamsObjects[player_id];
                if highlight then
                    highlight.Enabled = true;
                    highlight.FillColor = ChamsConfig.FillColor;
                    highlight.OutlineColor = ChamsConfig.OutlineColor;
                    highlight.FillTransparency = ChamsConfig.FillTransparency;
                    highlight.OutlineTransparency = ChamsConfig.OutlineTransparency;
                end;
            end;
        else
            RemoveChams(player_id);
        end;
    end;
end;

-- ğŸ”¥ SILENT AIM + AUTOFIRE ğŸ”¥
do
    local _G = getrenv()._G;
    local globals = _G.globals;
    local exe_map = debug.getupvalues(_G.append_exe_set)[1];
    
    local cli_state = globals.cli_state;
    local sol_teams = globals.sol_teams;
    local soldiers_spawned = globals.soldiers_spawned;
    local soldiers_alive = globals.soldiers_alive;
    local soldier_models = globals.soldier_models;
    
    local function get_closest_player()
        local closest_player;
        local closest_distance = math.huge;
        local fpv_id = cli_state.fpv_sol_id;
        local team = sol_teams[fpv_id];
        
        for player_id, spawned in pairs(soldiers_spawned) do
            if spawned and soldiers_alive[player_id] and player_id ~= fpv_id and sol_teams[player_id] ~= team then
                local character = soldier_models[player_id];
                if character and character.PrimaryPart then
                    local head = character:FindFirstChild("Head") or character.PrimaryPart;
                    local distance = (head.Position - CurrentCamera.CFrame.Position).Magnitude;
                    
                    -- Check autofire max distance
                    if AutofireConfig.Enabled and distance <= AutofireConfig.MaxDistance then
                        if distance < closest_distance then
                            closest_distance = distance;
                            closest_player = {part = head, distance = distance};
                        end;
                    elseif not AutofireConfig.Enabled then
                        if distance < closest_distance then
                            closest_distance = distance;
                            closest_player = {part = head, distance = distance};
                        end;
                    end;
                end;
            end;
        end;
        
        return closest_player;
    end;
    
    -- Hook bullet spawn for silent aim
    local old_spawn = exe_map[_G.exe_func_t.SPAWN_FPV_SOL_BULLET];
    exe_map[_G.exe_func_t.SPAWN_FPV_SOL_BULLET] = function(bullet_id, bullet_type, spawn_pos, velocity)
        local target = get_closest_player();
        if target then
            velocity = (target.part.Position - spawn_pos).Unit * velocity.Magnitude;
        end;
        return old_spawn(bullet_id, bullet_type, spawn_pos, velocity);
    end;
    
    -- ğŸ”¥ AUTOFIRE SYSTEM ğŸ”¥
    local function TryAutofire()
        if not AutofireConfig.Enabled then return end;
        
        local currentTime = tick();
        if currentTime - AutofireConfig.LastShot < AutofireConfig.Delay then return end;
        
        local target = get_closest_player();
        if not target then return end;
        
        -- Trigger shoot (simulate mouse click)
        AutofireConfig.LastShot = currentTime;
        
        -- Try to find and call the shoot function
        pcall(function()
            -- Method 1: Simulate mouse click
            mouse1click();
        end);
        
        -- Method 2: Try to find shoot remote/function
        pcall(function()
            if exe_map[_G.exe_func_t.FIRE_WEAPON] then
                exe_map[_G.exe_func_t.FIRE_WEAPON]();
            end;
        end);
        
        -- Method 3: Virtual input
        pcall(function()
            local VirtualInputManager = game:GetService("VirtualInputManager");
            VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 0);
            task.wait(0.01);
            VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 0);
        end);
    end;
    
    -- Autofire loop
    RunService.Heartbeat:Connect(function()
        if AutofireConfig.Enabled then
            TryAutofire();
        end;
    end);
end;

-- ğŸ”¥ CHAMS UPDATE LOOP ğŸ”¥
RunService.RenderStepped:Connect(UpdateChams);

-- ğŸ”¥ KEYBINDS ğŸ”¥
UserInputService.InputBegan:Connect(function(input, processed)
    if processed then return end;
    
    if input.KeyCode == Enum.KeyCode.Insert then
        ChamsConfig.Enabled = not ChamsConfig.Enabled;
        print("ğŸŒŸ Chams:", ChamsConfig.Enabled and "âœ… ON" or "âŒ OFF");
        
    elseif input.KeyCode == Enum.KeyCode.Home then
        AutofireConfig.Enabled = not AutofireConfig.Enabled;
        print("ğŸ”¥ Autofire:", AutofireConfig.Enabled and "âœ… ON" or "âŒ OFF");
        
    elseif input.KeyCode == Enum.KeyCode.End then
        ChamsConfig.TeamCheck = not ChamsConfig.TeamCheck;
        print("ğŸ‘¥ Team Check:", ChamsConfig.TeamCheck and "âœ… ON" or "âŒ OFF");
        
    elseif input.KeyCode == Enum.KeyCode.PageUp then
        -- Cycle chams color
        local colors = {
            {name = "Red", fill = Color3.fromRGB(255, 0, 0)},
            {name = "Green", fill = Color3.fromRGB(0, 255, 0)},
            {name = "Blue", fill = Color3.fromRGB(0, 100, 255)},
            {name = "Purple", fill = Color3.fromRGB(255, 0, 255)},
            {name = "Yellow", fill = Color3.fromRGB(255, 255, 0)},
        };
        
        local currentColor = ChamsConfig.FillColor;
        local nextIndex = 1;
        
        for i, color in ipairs(colors) do
            if color.fill == currentColor then
                nextIndex = (i % #colors) + 1;
                break;
            end;
        end;
        
        ChamsConfig.FillColor = colors[nextIndex].fill;
        print("ğŸ¨ Chams Color:", colors[nextIndex].name);
        
    elseif input.KeyCode == Enum.KeyCode.PageDown then
        -- Adjust autofire delay
        AutofireConfig.Delay = AutofireConfig.Delay + 0.05;
        if AutofireConfig.Delay > 0.5 then
            AutofireConfig.Delay = 0.05;
        end;
        print("â±ï¸ Autofire Delay:", AutofireConfig.Delay .. "s");
    end;
end);

-- ğŸ”¥ CLEANUP ON DEATH ğŸ”¥
local LocalPlayer = Players.LocalPlayer;
if LocalPlayer.Character then
    LocalPlayer.Character:WaitForChild("Humanoid").Died:Connect(function()
        for player_id, highlight in pairs(ChamsObjects) do
            RemoveChams(player_id);
        end;
    end);
end;

LocalPlayer.CharacterAdded:Connect(function(character)
    character:WaitForChild("Humanoid").Died:Connect(function()
        for player_id, highlight in pairs(ChamsObjects) do
            RemoveChams(player_id);
        end;
    end);
end);

print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
print("ğŸ¯ SILENT AIM + CHAMS + AUTOFIRE!");
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
print("âœ… Silent Aim: Always active");
print("âœ… Chams: Highlight enemies");
print("âœ… Autofire: Shoots automatically");
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
print("INSERT: Toggle Chams");
print("HOME: Toggle Autofire");
print("END: Toggle Team Check");
print("PAGE UP: Change Chams Color");
print("PAGE DOWN: Adjust Autofire Delay");
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
