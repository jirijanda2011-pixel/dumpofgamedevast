local Services = loadstring(game:HttpGet("https://raw.githubusercontent.com/AccountBurner/Utility/refs/heads/main/Services"))();
local Players, Workspace = Services:Get('Players', 'Workspace');
local CurrentCamera = Workspace.CurrentCamera;
local RunService = game:GetService("RunService");
local UserInputService = game:GetService("UserInputService");

-- ğŸ”¥ SKELETON ESP CONFIG ğŸ”¥
local SkeletonConfig = {
    Enabled = true,
    TeamCheck = true,
    Color = Color3.fromRGB(255, 80, 80),
    Thickness = 1.5,
    Transparency = 1,
    MaxDistance = 1200,
};

-- ğŸ”¥ AIMBOT CONFIG ğŸ”¥
local AimbotConfig = {
    Enabled = true,
    TeamCheck = true,
    MaxDistance = 500,
    FovRadius = 240,
    Smoothness = 0.2,
};

-- ğŸ”¥ AUTOFIRE CONFIG ğŸ”¥
local AutofireConfig = {
    Enabled = true,
    Delay = 0.1,
    MaxDistance = 500,
    LastShot = 0,
};

local SkeletonLines = {};
local SkeletonPairs = {
    {"Head", "UpperTorso"},
    {"UpperTorso", "LowerTorso"},
    {"UpperTorso", "LeftUpperArm"},
    {"LeftUpperArm", "LeftLowerArm"},
    {"LeftLowerArm", "LeftHand"},
    {"UpperTorso", "RightUpperArm"},
    {"RightUpperArm", "RightLowerArm"},
    {"RightLowerArm", "RightHand"},
    {"LowerTorso", "LeftUpperLeg"},
    {"LeftUpperLeg", "LeftLowerLeg"},
    {"LeftLowerLeg", "LeftFoot"},
    {"LowerTorso", "RightUpperLeg"},
    {"RightUpperLeg", "RightLowerLeg"},
    {"RightLowerLeg", "RightFoot"},
};

local function create_skeleton_lines(player_id)
    if SkeletonLines[player_id] then return end;

    SkeletonLines[player_id] = {};
    for _ = 1, #SkeletonPairs do
        local line = Drawing.new("Line");
        line.Visible = false;
        line.Color = SkeletonConfig.Color;
        line.Thickness = SkeletonConfig.Thickness;
        line.Transparency = SkeletonConfig.Transparency;
        SkeletonLines[player_id][#SkeletonLines[player_id] + 1] = line;
    end;
end;

local function remove_skeleton_lines(player_id)
    local lines = SkeletonLines[player_id];
    if not lines then return end;

    for _, line in ipairs(lines) do
        line:Remove();
    end;

    SkeletonLines[player_id] = nil;
end;

local function hide_skeleton_lines(player_id)
    local lines = SkeletonLines[player_id];
    if not lines then return end;

    for _, line in ipairs(lines) do
        line.Visible = false;
    end;
end;

local function get_globals()
    local _G = getrenv()._G;
    local globals = _G.globals;

    return _G, globals, globals.cli_state, globals.sol_teams, globals.soldiers_spawned, globals.soldiers_alive, globals.soldier_models;
end;

local function is_target_visible(target_part)
    local _, on_screen = CurrentCamera:WorldToViewportPoint(target_part.Position);
    if not on_screen then
        return false;
    end;

    local local_character = Players.LocalPlayer and Players.LocalPlayer.Character;
    local exclude_instances = {target_part.Parent};
    if local_character then
        table.insert(exclude_instances, local_character);
    end;

    local raycast_params = RaycastParams.new();
    raycast_params.FilterType = Enum.RaycastFilterType.Exclude;
    raycast_params.FilterDescendantsInstances = exclude_instances;

    local origin = CurrentCamera.CFrame.Position;
    local direction = target_part.Position - origin;
    local ray_result = Workspace:Raycast(origin, direction, raycast_params);

    return ray_result == nil;
end;

local function get_best_target(require_visible, max_distance, fov_radius)
    local _, _, cli_state, sol_teams, soldiers_spawned, soldiers_alive, soldier_models = get_globals();

    local fpv_id = cli_state.fpv_sol_id;
    local local_team = sol_teams[fpv_id];
    local viewport_center = Vector2.new(CurrentCamera.ViewportSize.X * 0.5, CurrentCamera.ViewportSize.Y * 0.5);
    local closest_player;
    local closest_score = math.huge;

    for player_id, spawned in pairs(soldiers_spawned) do
        local same_team = sol_teams[player_id] == local_team;
        if spawned and soldiers_alive[player_id] and player_id ~= fpv_id and (not AimbotConfig.TeamCheck or not same_team) then
            local character = soldier_models[player_id];
            if character and character.PrimaryPart then
                local aim_part = character:FindFirstChild("Head") or character.PrimaryPart;
                local world_distance = (aim_part.Position - CurrentCamera.CFrame.Position).Magnitude;

                if world_distance <= max_distance then
                    local screen_pos, on_screen = CurrentCamera:WorldToViewportPoint(aim_part.Position);
                    if on_screen then
                        local delta = Vector2.new(screen_pos.X, screen_pos.Y) - viewport_center;
                        local screen_distance = delta.Magnitude;

                        if screen_distance <= fov_radius then
                            if (not require_visible) or is_target_visible(aim_part) then
                                if screen_distance < closest_score then
                                    closest_score = screen_distance;
                                    closest_player = {
                                        part = aim_part,
                                        character = character,
                                        distance = world_distance,
                                        screen = Vector2.new(screen_pos.X, screen_pos.Y),
                                    };
                                end;
                            end;
                        end;
                    end;
                end;
            end;
        end;
    end;

    return closest_player;
end;

local function update_skeleton_esp()
    local _, _, cli_state, sol_teams, soldiers_spawned, soldiers_alive, soldier_models = get_globals();

    if not SkeletonConfig.Enabled then
        for player_id in pairs(SkeletonLines) do
            hide_skeleton_lines(player_id);
        end;
        return;
    end;

    local fpv_id = cli_state.fpv_sol_id;
    local local_team = sol_teams[fpv_id];

    for player_id in pairs(SkeletonLines) do
        if not soldiers_spawned[player_id] or not soldiers_alive[player_id] then
            remove_skeleton_lines(player_id);
        end;
    end;

    for player_id, spawned in pairs(soldiers_spawned) do
        local enemy_valid = spawned and soldiers_alive[player_id] and player_id ~= fpv_id;
        if not enemy_valid then
            hide_skeleton_lines(player_id);
            continue;
        end;

        if SkeletonConfig.TeamCheck and sol_teams[player_id] == local_team then
            hide_skeleton_lines(player_id);
            continue;
        end;

        local character = soldier_models[player_id];
        if not character or not character.PrimaryPart then
            hide_skeleton_lines(player_id);
            continue;
        end;

        if (character.PrimaryPart.Position - CurrentCamera.CFrame.Position).Magnitude > SkeletonConfig.MaxDistance then
            hide_skeleton_lines(player_id);
            continue;
        end;

        create_skeleton_lines(player_id);
        local lines = SkeletonLines[player_id];

        for index, pair in ipairs(SkeletonPairs) do
            local part_a = character:FindFirstChild(pair[1]);
            local part_b = character:FindFirstChild(pair[2]);
            local line = lines[index];

            if part_a and part_b then
                local point_a, visible_a = CurrentCamera:WorldToViewportPoint(part_a.Position);
                local point_b, visible_b = CurrentCamera:WorldToViewportPoint(part_b.Position);

                if visible_a and visible_b then
                    line.Color = SkeletonConfig.Color;
                    line.Thickness = SkeletonConfig.Thickness;
                    line.Transparency = SkeletonConfig.Transparency;
                    line.From = Vector2.new(point_a.X, point_a.Y);
                    line.To = Vector2.new(point_b.X, point_b.Y);
                    line.Visible = true;
                else
                    line.Visible = false;
                end;
            else
                line.Visible = false;
            end;
        end;
    end;
end;

local function run_aimbot()
    if not AimbotConfig.Enabled then return end;

    local target = get_best_target(true, AimbotConfig.MaxDistance, AimbotConfig.FovRadius);
    if not target then return end;

    local viewport_center = Vector2.new(CurrentCamera.ViewportSize.X * 0.5, CurrentCamera.ViewportSize.Y * 0.5);
    local delta = target.screen - viewport_center;

    local move_x = delta.X * AimbotConfig.Smoothness;
    local move_y = delta.Y * AimbotConfig.Smoothness;

    if math.abs(move_x) < 0.5 and math.abs(move_y) < 0.5 then
        return;
    end;

    pcall(function()
        mousemoverel(move_x, move_y);
    end);
end;

local function try_autofire()
    if not AutofireConfig.Enabled then return end;

    local current_time = tick();
    if current_time - AutofireConfig.LastShot < AutofireConfig.Delay then return end;

    local target = get_best_target(true, AutofireConfig.MaxDistance, AimbotConfig.FovRadius);
    if not target then return end;

    AutofireConfig.LastShot = current_time;

    pcall(function()
        mouse1click();
    end);

    pcall(function()
        local VirtualInputManager = game:GetService("VirtualInputManager");
        VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 0);
        task.wait(0.01);
        VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 0);
    end);
end;

RunService.RenderStepped:Connect(function()
    update_skeleton_esp();
    run_aimbot();
end);

RunService.Heartbeat:Connect(function()
    try_autofire();
end);

UserInputService.InputBegan:Connect(function(input, processed)
    if processed then return end;

    if input.KeyCode == Enum.KeyCode.Insert then
        SkeletonConfig.Enabled = not SkeletonConfig.Enabled;
        print("ğŸ¦´ Skeleton ESP:", SkeletonConfig.Enabled and "âœ… ON" or "âŒ OFF");

    elseif input.KeyCode == Enum.KeyCode.Home then
        AutofireConfig.Enabled = not AutofireConfig.Enabled;
        print("ğŸ”¥ Autofire:", AutofireConfig.Enabled and "âœ… ON" or "âŒ OFF");

    elseif input.KeyCode == Enum.KeyCode.End then
        AimbotConfig.Enabled = not AimbotConfig.Enabled;
        print("ğŸ¯ Aimbot:", AimbotConfig.Enabled and "âœ… ON" or "âŒ OFF");

    elseif input.KeyCode == Enum.KeyCode.PageUp then
        AimbotConfig.Smoothness = math.clamp(AimbotConfig.Smoothness + 0.05, 0.05, 1);
        print("ğŸ–±ï¸ Aimbot Smoothness:", string.format("%.2f", AimbotConfig.Smoothness));

    elseif input.KeyCode == Enum.KeyCode.PageDown then
        AutofireConfig.Delay = AutofireConfig.Delay + 0.05;
        if AutofireConfig.Delay > 0.5 then
            AutofireConfig.Delay = 0.05;
        end;
        print("â±ï¸ Autofire Delay:", string.format("%.2fs", AutofireConfig.Delay));
    end;
end);

local function cleanup_esp()
    for player_id in pairs(SkeletonLines) do
        remove_skeleton_lines(player_id);
    end;
end;

local LocalPlayer = Players.LocalPlayer;
if LocalPlayer.Character then
    LocalPlayer.Character:WaitForChild("Humanoid").Died:Connect(cleanup_esp);
end;

LocalPlayer.CharacterAdded:Connect(function(character)
    character:WaitForChild("Humanoid").Died:Connect(cleanup_esp);
end);

print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
print("ğŸ¯ MOUSE AIMBOT + SKELETON ESP + AUTOFIRE");
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
print("âœ… Aimbot: mousemoverel legit aim");
print("âœ… Skeleton ESP: enemy bones");
print("âœ… Autofire: visible targets only");
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
print("INSERT: Toggle Skeleton ESP");
print("HOME: Toggle Autofire");
print("END: Toggle Aimbot");
print("PAGE UP: Increase Aimbot Smoothness");
print("PAGE DOWN: Adjust Autofire Delay");
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
